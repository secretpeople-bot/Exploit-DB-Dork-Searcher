import requests
import time
import os
from bs4 import BeautifulSoup
from colorama import Fore, Style

def print_loading_animation():
    for i in range(10):
        time.sleep(0.1)
        print(Fore.CYAN + "\rPlease Wait " + Style.RESET_ALL + "[ " + Fore.YELLOW + "/-\|"[i % 4] + Style.RESET_ALL + " ]", end="")

url = "https://www.exploit-db.com/google-hacking-database"
params = {"start": 0, "length": 1}

headers = {
    "Accept": "application/json, text/javascript, */*; q=0.01",
    "X-Requested-With": "XMLHttpRequest",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36",
    "Referer": "https://www.exploit-db.com/google-hacking-database",
}

os.system('cls' if os.name == 'nt' else 'clear')

banner = '''
███████╗██╗  ██╗██████╗ ██╗      ██████╗ ██╗████████╗   ██████╗ ██████╗     ██████╗  ██████╗ ██████╗ ██╗  ██╗
██╔════╝╚██╗██╔╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝   ██╔══██╗██╔══██╗    ██╔══██╗██╔═══██╗██╔══██╗██║ ██╔╝
█████╗   ╚███╔╝ ██████╔╝██║     ██║   ██║██║   ██║█████╗██║  ██║██████╔╝    ██║  ██║██║   ██║██████╔╝█████╔╝ 
██╔══╝   ██╔██╗ ██╔═══╝ ██║     ██║   ██║██║   ██║╚════╝██║  ██║██╔══██╗    ██║  ██║██║   ██║██╔══██╗██╔═██╗ 
███████╗██╔╝ ██╗██║     ███████╗╚██████╔╝██║   ██║      ██████╔╝██████╔╝    ██████╔╝╚██████╔╝██║  ██║██║  ██╗
╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝      ╚═════╝ ╚═════╝     ╚═════╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝
                                                                                                             
                                                                                                             
Priv8 Exploit-DB Google Dork Searcher
Coded by Vexelvox
'''
print(Fore.GREEN + banner + Style.RESET_ALL)
query = input("Input Query, ex 'json': ").lower()

response = requests.get(url, headers=headers, params=params)
json_data = response.json()
total_records = json_data["recordsTotal"]

num_records = int(total_records)

for i in range(num_records):
    params["start"] = i

    response = requests.get(url, headers=headers, params=params)
    json_data = response.json()
    data = json_data["data"]

    for record in data:
        url_title = record['url_title']
        soup = BeautifulSoup(url_title, 'html.parser')
        url_title_text = soup.get_text().lower()
        if query in url_title_text:
            print(f"\n{Fore.GREEN}Record {i + 1}{Style.RESET_ALL}")
            print("-------------")
            print(f"Date: {record['date']}")
            print(f"Dork: {url_title_text}")
            print(f"Author Name: {record['author']['name']}")
            print(f"Category Title: {record['category']['cat_title']}")
            print(f"Category Description: {record['category']['cat_description']}")
            with open("results.txt", "a") as file:
                file.write(f"Record {i + 1}\n")
                file.write("-------------\n")
                file.write(f"Date: {record['date']}\n")
                file.write(f"Dork: {url_title_text}\n")
                file.write(f"Author Name: {record['author']['name']}\n")
                file.write(f"Category Title: {record['category']['cat_title']}\n")
                file.write(f"Category Description: {record['category']['cat_description']}\n\n")
            break
    else:
        print_loading_animation()
        
print(f"\n{Fore.BLUE}Done.{Style.RESET_ALL}")
